"use strict";(self.webpackChunkbook_network_ui=self.webpackChunkbook_network_ui||[]).push([[488],{5488:(B,_,c)=>{c.r(_),c.d(_,{ProfileModule:()=>Y});var f=c(6814),l=c(6223),p=c(2058),e=c(9291),m=c(8440),h=c(9862);let b=(()=>{class o{constructor(t,n){this.http=t,this.keycloakService=n,this.baseUrl="http://localhost:8088/api/v1/api/v1/users"}getAuthHeaders(){return new h.WM(this.keycloakService.getAuthHeader())}getCurrentUserProfile(){return console.log("\u{1f525} Calling:",`${this.baseUrl}/profile`),this.http.get(`${this.baseUrl}/profile`,{headers:this.getAuthHeaders()})}getUserProfile(t){const n=encodeURIComponent(t),r=`${this.baseUrl}/profile/${n}`;return console.log("\u{1f525} Calling:",r),this.http.get(r,{headers:this.getAuthHeaders()})}updateProfileImage(t){return this.http.put(`${this.baseUrl}/profile/image`,{profileImageUrl:t},{headers:this.getAuthHeaders()})}static#e=this.\u0275fac=function(n){return new(n||o)(e.LFG(h.eN),e.LFG(m.M))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function C(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"input",37),e.NdJ("change",function(r){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onProfileImageSelected(r))}),e.qZA()}}function P(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"button",38),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.triggerFileInput())}),e.TgZ(1,"i",39),e._uU(2,"\u{1f4f7}"),e.qZA()()}}function M(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",40)(1,"button",41),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.editProfile())}),e.TgZ(2,"i",39),e._uU(3,"\u270f\ufe0f"),e.qZA(),e._uU(4," Edit Profile "),e.qZA()()}}function v(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",3),e._UZ(1,"div",4),e.TgZ(2,"div",5)(3,"div",6)(4,"h1"),e._uU(5),e.qZA(),e.TgZ(6,"button",7),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.goBack())}),e._uU(7," \u2190 Return to Library "),e.qZA()(),e.TgZ(8,"div",8)(9,"div",9)(10,"div",10)(11,"div",11)(12,"img",12),e.NdJ("error",function(r){e.CHM(t);const i=e.oxw();return e.KtG(i.onImageError(r))}),e.qZA(),e.YNc(13,C,1,0,"input",13),e.YNc(14,P,3,0,"button",14),e.qZA(),e.TgZ(15,"div",15)(16,"h2",16),e._uU(17),e.qZA(),e.TgZ(18,"p",17),e._uU(19),e.qZA(),e.TgZ(20,"p",18),e._uU(21),e.qZA(),e.TgZ(22,"div",19)(23,"div",20)(24,"span",21),e._uU(25),e.qZA(),e.TgZ(26,"span",22),e._uU(27,"Books"),e.qZA()()()()(),e.YNc(28,M,5,0,"div",23),e.qZA(),e.TgZ(29,"div",24)(30,"h3",25),e._uU(31,"Profile Details"),e.qZA(),e.TgZ(32,"div",26)(33,"div",27)(34,"label"),e._uU(35,"Username"),e.qZA(),e.TgZ(36,"div",28),e._uU(37),e.qZA()(),e.TgZ(38,"div",27)(39,"label"),e._uU(40,"Full Name"),e.qZA(),e.TgZ(41,"div",28),e._uU(42),e.qZA()(),e.TgZ(43,"div",27)(44,"label"),e._uU(45,"Email Address"),e.qZA(),e.TgZ(46,"div",28),e._uU(47),e.qZA()(),e.TgZ(48,"div",27)(49,"label"),e._uU(50,"Member Since"),e.qZA(),e.TgZ(51,"div",28),e._uU(52),e.qZA()()()()(),e.TgZ(53,"div",29)(54,"div",30)(55,"div",31)(56,"div",32),e._uU(57,"\u{1f4da}"),e.qZA(),e.TgZ(58,"h3"),e._uU(59),e.qZA(),e.TgZ(60,"span",33),e._uU(61),e.qZA()(),e.TgZ(62,"div",34)(63,"div",35)(64,"div",36),e._uU(65,"\u{1f4d6}"),e.qZA(),e.TgZ(66,"h4"),e._uU(67,"Books Coming Soon"),e.qZA(),e.TgZ(68,"p"),e._uU(69,"The book library feature will be available in a future update."),e.qZA()()()()()()()}if(2&o){const t=e.oxw();e.xp6(5),e.hij("",t.displayName,"'s Profile"),e.xp6(7),e.Q6J("src",t.profileImageSrc,e.LSH),e.xp6(1),e.Q6J("ngIf",t.isCurrentUser),e.xp6(1),e.Q6J("ngIf",t.isCurrentUser),e.xp6(3),e.Oqu(t.formattedFullName),e.xp6(2),e.hij("@",t.formattedUsername,""),e.xp6(2),e.Oqu(t.formattedEmail),e.xp6(4),e.Oqu((null==t.realUserProfile?null:t.realUserProfile.booksCount)||0),e.xp6(3),e.Q6J("ngIf",t.isCurrentUser),e.xp6(9),e.Oqu(t.formattedUsername),e.xp6(5),e.Oqu(t.formattedFullName),e.xp6(5),e.Oqu(t.formattedEmail),e.xp6(5),e.Oqu(t.getCurrentDate()),e.xp6(7),e.hij("",t.displayName,"'s Library"),e.xp6(2),e.hij("",(null==t.realUserProfile?null:t.realUserProfile.booksCount)||0," books")}}function k(o,a){1&o&&(e.TgZ(0,"div",42)(1,"div",43),e._UZ(2,"div",44),e.TgZ(3,"p"),e._uU(4,"Loading profile..."),e.qZA()()())}function O(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",45)(1,"div",46)(2,"div",47),e._uU(3,"\u26a0\ufe0f"),e.qZA(),e.TgZ(4,"h3"),e._uU(5,"Oops! Something went wrong"),e.qZA(),e.TgZ(6,"p"),e._uU(7),e.qZA(),e.TgZ(8,"button",48),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.goBack())}),e._uU(9," \u2190 Go Back "),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(7),e.Oqu(t.errorMessage)}}let x=(()=>{class o{constructor(t,n,r,i){this.keycloakService=t,this.userService=n,this.router=r,this.route=i,this.realUserProfile=null,this.loading=!1,this.isCurrentUser=!0,this.viewUsername=null,this.errorMessage=null,this.displayName="User",this.profileImageSrc="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDE1MCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxNTAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRjNGNEY2Ii8+CjxjaXJjbGUgY3g9Ijc1IiBjeT0iNjAiIHI9IjI1IiBmaWxsPSIjRDBENEREIi8+CjxwYXRoIGQ9Ik0zMCAxMjBDMzAgMTA0LjUzNiA0Mi41MzYgOTIgNTggOTJIOTJDMTA3LjQ2NCA5MiAxMjAgMTA0LjUzNiAxMjAgMTIwVjE1MEgzMFYxMjBaIiBmaWxsPSIjRDBENEREIi8+Cjwvc3ZnPgo=",this.formattedUsername="",this.formattedFullName="",this.formattedEmail=""}ngOnInit(){this.routeSubscription=this.route.paramMap.subscribe(t=>{const n=t.get("username");this.viewUsername=n,this.viewUsername?(console.log("Viewing profile for user:",this.viewUsername),this.isCurrentUser=this.viewUsername===(this.keycloakService.username||""),this.isCurrentUser?this.loadCurrentUserProfile():this.loadOtherUserProfile(this.viewUsername)):this.loadCurrentUserProfile()})}ngAfterViewInit(){console.log("\u{1f525} DOM fixing d\xe9sactiv\xe9 pour corriger l'affichage des emails")}ngOnDestroy(){this.routeSubscription&&this.routeSubscription.unsubscribe()}loadCurrentUserProfile(){this.loading=!0,this.errorMessage=null,this.isCurrentUser=!0,this.userService.getCurrentUserProfile().subscribe({next:t=>{this.realUserProfile=t,console.log("=== PROFIL UTILISATEUR ACTUEL ==="),console.log("Username:",t.username),console.log("FirstName:",t.firstName),console.log("LastName:",t.lastName),console.log("Email:",t.email),console.log("ProfilePictureUrl:",t.profilePictureUrl),console.log("ID:",t.id),console.log("=================================="),this.updateDisplayFromRealProfile(t),this.loading=!1},error:t=>{console.error("Error loading current user profile:",t),this.handleProfileLoadError(t,"current user"),this.fallbackToKeycloakProfile(),this.loading=!1}})}loadOtherUserProfile(t){console.log("Loading profile for user:",t),this.loading=!0,this.errorMessage=null,this.userService.getUserProfile(t).subscribe({next:n=>{this.realUserProfile=n,console.log("=== PROFIL AUTRE UTILISATEUR ==="),console.log("Username:",n.username),console.log("FirstName:",n.firstName),console.log("LastName:",n.lastName),console.log("Email:",n.email),console.log("ProfilePictureUrl:",n.profilePictureUrl),console.log("ID:",n.id),console.log("================================"),this.updateDisplayFromRealProfile(n),this.loading=!1},error:n=>{console.error("Error loading user profile:",n),this.handleProfileLoadError(n,t),this.loading=!1}})}updateDisplayFromRealProfile(t){console.log("\u{1f525} DEBUT updateDisplayFromRealProfile avec:",t);const n=t.username||"Unknown";this.formattedUsername=n.includes("@")?n.split("@")[0]:n;const r=t.firstName||"",i=t.lastName||"";this.formattedFullName=r&&i?`${r} ${i}`.trim():r||i?(r+i).trim():this.formattedUsername,this.formattedEmail=t.email||"No email provided",this.displayName=r||i?this.formattedFullName:this.formattedUsername;const s=this.isCurrentUser?"My Profile - Book Network":`${this.formattedUsername}'s Profile - Book Network`;document.title=s,this.setProfileImage(t.profilePictureUrl),console.log("\u{1f525} R\xc9SULTAT FINAL:"),console.log("- Raw Username:",n),console.log("- Formatted Username:",this.formattedUsername),console.log("- Full Name:",this.formattedFullName),console.log("- Email:",this.formattedEmail),console.log("- Display Name:",this.displayName),console.log("- Page Title:",s),console.log("- Image:",this.profileImageSrc)}setProfileImage(t){if(console.log("\u{1f525} setProfileImage - URL from DB:",t),t&&""!==t.trim())return this.profileImageSrc=t,void console.log("\u{1f525} Using database image URL");if(this.isCurrentUser){const d=localStorage.getItem(`profileImage_${this.keycloakService.username||"default-user"}`);if(d)return this.profileImageSrc=d,void console.log("\u{1f525} Using localStorage image for current user")}const n=[`https://i.pravatar.cc/150?u=${encodeURIComponent(this.formattedEmail||this.formattedUsername)}`,`https://robohash.org/${encodeURIComponent(this.formattedEmail||this.formattedUsername)}?size=150x150&set=set1`,`https://robohash.org/${encodeURIComponent(this.formattedEmail||this.formattedUsername)}?size=150x150&set=set4`,`https://robohash.org/${encodeURIComponent(this.formattedEmail||this.formattedUsername)}?size=150x150&set=set2`,`https://api.dicebear.com/7.x/shapes/svg?seed=${encodeURIComponent(this.formattedEmail||this.formattedUsername)}&size=150`,`https://api.dicebear.com/7.x/bottts/svg?seed=${encodeURIComponent(this.formattedEmail||this.formattedUsername)}&size=150`,`https://api.dicebear.com/7.x/adventurer/svg?seed=${encodeURIComponent(this.formattedEmail||this.formattedUsername)}&size=150`,`https://api.dicebear.com/7.x/personas/svg?seed=${encodeURIComponent(this.formattedEmail||this.formattedUsername)}&size=150`],s=n[this.generateSimpleHash(this.formattedEmail||this.formattedUsername||"default")%n.length];this.profileImageSrc=s,console.log("\u{1f525} Using fun avatar:",s)}generateSimpleHash(t){let n=0;for(let r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r),n&=n;return Math.abs(n)}handleProfileLoadError(t,n){this.errorMessage=404===t.status?"current user"===n?"Your profile could not be found. Please contact support.":"User not found":403===t.status?"You do not have permission to view this profile":0===t.status?"Network error. Please check your connection and try again.":`Error loading profile (${t.status||"Unknown"})`}fallbackToKeycloakProfile(){if(console.log("\u{1f525} FALLBACK vers Keycloak profile"),!this.isCurrentUser)return void(this.errorMessage="Unable to load user profile");this.userProfile=this.keycloakService.profile;const t=this.keycloakService.username||"";this.formattedUsername=t.includes("@")?t.split("@")[0]:t,this.displayName=this.formattedUsername,this.formattedFullName=this.formattedUsername,this.formattedEmail=this.keycloakService.profile?.email||`${t}@example.com`,this.loadProfileImageFromLocalStorage()}loadProfileImageFromLocalStorage(){if(!this.isCurrentUser)return;const n=localStorage.getItem(`profileImage_${this.keycloakService.username||"default-user"}`);n?(this.profileImageSrc=n,console.log("\u{1f525} Image loaded from localStorage")):(this.profileImageSrc="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDE1MCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxNTAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRjNGNEY2Ii8+CjxjaXJjbGUgY3g9Ijc1IiBjeT0iNjAiIHI9IjI1IiBmaWxsPSIjRDBENEREIi8+CjxwYXRoIGQ9Ik0zMCAxMjBDMzAgMTA0LjUzNiA0Mi41MzYgOTIgNTggOTJIOTJDMTA3LjQ2NCA5MiAxMjAgMTA0LjUzNiAxMjAgMTIwVjE1MEgzMFYxMjBaIiBmaWxsPSIjRDBENEREIi8+Cjwvc3ZnPgo=",console.log("\u{1f525} Using default placeholder"))}editProfile(){if(!this.isCurrentUser)return;const t=this.keycloakService.keycloakInstance.authServerUrl,n=this.keycloakService.keycloakInstance.realm;t&&n?window.location.href=`${t}/realms/${n}/account`:(console.error("Unable to determine Keycloak URL"),this.errorMessage="Unable to access account settings")}goBack(){this.router.navigate(["/books"])}triggerFileInput(){if(!this.isCurrentUser)return;const t=document.getElementById("profile-image-upload");t&&t.click()}onProfileImageSelected(t){if(!this.isCurrentUser)return;const n=t.target.files[0];if(!n)return;if(!n.type.startsWith("image/"))return void(this.errorMessage="Please select a valid image file");if(n.size>5242880)return void(this.errorMessage="Image file size must be less than 5MB");const r=new FileReader;r.onload=i=>{this.profileImageSrc=i.target.result;const s=this.keycloakService.username||"default-user";localStorage.setItem(`profileImage_${s}`,this.profileImageSrc),console.log("\u{1f525} Image saved to localStorage:",`profileImage_${s}`)},r.onerror=()=>{this.errorMessage="Error reading the image file"},r.readAsDataURL(n)}onImageError(t){console.log("\u{1f525} Image failed to load, using fallback"),t.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDE1MCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxNTAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRjNGNEY2Ii8+CjxjaXJjbGUgY3g9Ijc1IiBjeT0iNjAiIHI9IjI1IiBmaWxsPSIjRDBENEREIi8+CjxwYXRoIGQ9Ik0zMCAxMjBDMzAgMTA0LjUzNiA0Mi41MzYgOTIgNTggOTJIOTJDMTA3LjQ2NCA5MiAxMjAgMTA0LjUzNiAxMjAgMTIwVjE1MEgzMFYxMjBaIiBmaWxsPSIjRDBENEREIi8+Cjwvc3ZnPgo="}getCurrentDate(){return(new Date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(m.M),e.Y36(b),e.Y36(p.F0),e.Y36(p.gz))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-profile"]],decls:3,vars:3,consts:[["class","profile-container",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","error-container",4,"ngIf"],[1,"profile-container"],[1,"profile-sidebar"],[1,"profile-main"],[1,"profile-header"],[1,"back-button",3,"click"],[1,"profile-content"],[1,"profile-card"],[1,"profile-main-info"],[1,"profile-avatar"],["alt","Profile picture",1,"avatar-image",3,"src","error"],["type","file","id","profile-image-upload","accept","image/*","style","display: none;",3,"change",4,"ngIf"],["class","avatar-change-btn",3,"click",4,"ngIf"],[1,"profile-basic-info"],[1,"profile-name"],[1,"profile-username"],[1,"profile-email"],[1,"profile-stats"],[1,"stat-item"],[1,"stat-number"],[1,"stat-label"],["class","profile-actions",4,"ngIf"],[1,"details-card"],[1,"card-title"],[1,"detail-grid"],[1,"detail-item"],[1,"detail-value"],[1,"books-section"],[1,"books-card"],[1,"books-header"],[1,"books-icon"],[1,"books-count"],[1,"books-content"],[1,"books-placeholder"],[1,"placeholder-icon"],["type","file","id","profile-image-upload","accept","image/*",2,"display","none",3,"change"],[1,"avatar-change-btn",3,"click"],[1,"icon"],[1,"profile-actions"],[1,"edit-button",3,"click"],[1,"loading-container"],[1,"loading-card"],[1,"spinner"],[1,"error-container"],[1,"error-card"],[1,"error-icon"],[1,"retry-button",3,"click"]],template:function(n,r){1&n&&(e.YNc(0,v,70,15,"div",0),e.YNc(1,k,5,0,"div",1),e.YNc(2,O,10,1,"div",2)),2&n&&(e.Q6J("ngIf",!r.loading&&!r.errorMessage),e.xp6(1),e.Q6J("ngIf",r.loading),e.xp6(1),e.Q6J("ngIf",r.errorMessage))},dependencies:[f.O5],styles:['@charset "UTF-8";.profile-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);position:relative}.profile-sidebar[_ngcontent-%COMP%]{width:80px;background:rgba(255,255,255,.1);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-right:1px solid rgba(255,255,255,.2);min-height:100vh;flex-shrink:0}.profile-main[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.profile-header[_ngcontent-%COMP%]{background:rgba(255,255,255,.1);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);color:#fff;padding:25px 40px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(255,255,255,.2)}.profile-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:32px;font-weight:700;text-shadow:0 2px 4px rgba(0,0,0,.1)}.back-button[_ngcontent-%COMP%]{background:rgba(255,255,255,.2);color:#fff;border:none;padding:12px 24px;border-radius:30px;cursor:pointer;font-size:16px;font-weight:500;transition:all .3s ease;display:flex;align-items:center;gap:10px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.back-button[_ngcontent-%COMP%]:hover{background:rgba(255,255,255,.3);transform:translateY(-2px);box-shadow:0 8px 25px #00000026}.profile-content[_ngcontent-%COMP%]{padding:40px;display:grid;grid-template-columns:1fr 400px;gap:30px;flex:1}.profile-card[_ngcontent-%COMP%]{background:rgba(255,255,255,.95);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-radius:24px;padding:40px;box-shadow:0 20px 40px #0000001a;border:1px solid rgba(255,255,255,.2);transition:all .3s ease}.profile-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 30px 60px #00000026}.profile-main-info[_ngcontent-%COMP%]{display:flex;gap:30px;align-items:flex-start;margin-bottom:30px}.profile-avatar[_ngcontent-%COMP%]{position:relative;flex-shrink:0}.profile-avatar[_ngcontent-%COMP%]   .avatar-image[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:24px;object-fit:cover;border:4px solid rgba(255,255,255,.8);box-shadow:0 10px 30px #00000026;transition:all .3s ease}.profile-avatar[_ngcontent-%COMP%]   .avatar-image[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 15px 40px #0003}.profile-avatar[_ngcontent-%COMP%]   .avatar-change-btn[_ngcontent-%COMP%]{position:absolute;bottom:-5px;right:-5px;width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border:3px solid white;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:16px;transition:all .3s ease;box-shadow:0 5px 15px #0003}.profile-avatar[_ngcontent-%COMP%]   .avatar-change-btn[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 8px 25px #0000004d}.profile-avatar[_ngcontent-%COMP%]   .avatar-change-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:none}.profile-basic-info[_ngcontent-%COMP%]{flex:1}.profile-basic-info[_ngcontent-%COMP%]   .profile-name[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#2d3748;margin:0 0 8px}.profile-basic-info[_ngcontent-%COMP%]   .profile-username[_ngcontent-%COMP%]{font-size:18px;color:#667eea;font-weight:500;margin:0 0 8px}.profile-basic-info[_ngcontent-%COMP%]   .profile-email[_ngcontent-%COMP%]{font-size:16px;color:#718096;margin:0 0 20px}.profile-stats[_ngcontent-%COMP%]{display:flex;gap:20px}.profile-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{text-align:center;padding:15px 20px;background:linear-gradient(135deg,#f7fafc 0%,#edf2f7 100%);border-radius:16px;border:1px solid rgba(0,0,0,.05)}.profile-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{display:block;font-size:24px;font-weight:700;color:#2d3748;margin-bottom:4px}.profile-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:14px;color:#718096;font-weight:500}.profile-actions[_ngcontent-%COMP%]   .edit-button[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4CAF50 0%,#45a049 100%);color:#fff;border:none;padding:14px 28px;border-radius:16px;cursor:pointer;font-size:16px;font-weight:600;transition:all .3s ease;display:flex;align-items:center;gap:10px;box-shadow:0 8px 20px #4caf504d}.profile-actions[_ngcontent-%COMP%]   .edit-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 12px 30px #4caf5066}.profile-actions[_ngcontent-%COMP%]   .edit-button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{filter:none}.details-card[_ngcontent-%COMP%]{background:rgba(255,255,255,.95);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-radius:24px;padding:30px;box-shadow:0 20px 40px #0000001a;border:1px solid rgba(255,255,255,.2);height:-moz-fit-content;height:fit-content}.details-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#2d3748;margin:0 0 25px}.detail-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.detail-grid[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:600;color:#4a5568;margin-bottom:8px;text-transform:uppercase;letter-spacing:.5px}.detail-grid[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{padding:12px 16px;background:#f7fafc;border:2px solid #e2e8f0;border-radius:12px;font-size:15px;color:#2d3748;transition:all .3s ease}.detail-grid[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]:hover{border-color:#667eea;background:#edf2f7}.books-section[_ngcontent-%COMP%]{padding:0 40px 40px}.books-section[_ngcontent-%COMP%]   .books-card[_ngcontent-%COMP%]{background:rgba(255,255,255,.95);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-radius:24px;padding:30px;box-shadow:0 20px 40px #0000001a;border:1px solid rgba(255,255,255,.2)}.books-section[_ngcontent-%COMP%]   .books-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:25px;padding-bottom:20px;border-bottom:2px solid #f1f5f9}.books-section[_ngcontent-%COMP%]   .books-header[_ngcontent-%COMP%]   .books-icon[_ngcontent-%COMP%]{width:50px;height:50px;background:linear-gradient(135deg,#ff6b6b 0%,#ffa500 100%);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:24px;box-shadow:0 8px 20px #ff6b6b4d}.books-section[_ngcontent-%COMP%]   .books-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{flex:1;margin:0 20px;font-size:24px;font-weight:700;color:#2d3748}.books-section[_ngcontent-%COMP%]   .books-header[_ngcontent-%COMP%]   .books-count[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:8px 16px;border-radius:20px;font-size:14px;font-weight:600}.books-section[_ngcontent-%COMP%]   .books-placeholder[_ngcontent-%COMP%]{text-align:center;padding:40px 20px}.books-section[_ngcontent-%COMP%]   .books-placeholder[_ngcontent-%COMP%]   .placeholder-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:20px;opacity:.6}.books-section[_ngcontent-%COMP%]   .books-placeholder[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#4a5568;margin:0 0 10px}.books-section[_ngcontent-%COMP%]   .books-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#718096;font-size:16px;line-height:1.6}.loading-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:100vh;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}.loading-container[_ngcontent-%COMP%]   .loading-card[_ngcontent-%COMP%]{background:rgba(255,255,255,.95);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-radius:24px;padding:40px;text-align:center;box-shadow:0 20px 40px #0000001a}.loading-container[_ngcontent-%COMP%]   .loading-card[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:4px solid #e2e8f0;border-top:4px solid #667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 20px}.loading-container[_ngcontent-%COMP%]   .loading-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#4a5568;font-size:18px;font-weight:500}.error-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:100vh;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]{background:rgba(255,255,255,.95);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-radius:24px;padding:40px;text-align:center;box-shadow:0 20px 40px #0000001a;max-width:400px}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:20px}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:22px;font-weight:700;color:#e53e3e;margin:0 0 15px}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#4a5568;font-size:16px;margin:0 0 25px;line-height:1.6}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   .retry-button[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border:none;padding:12px 24px;border-radius:16px;cursor:pointer;font-size:16px;font-weight:600;transition:all .3s ease}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   .retry-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #667eea66}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 1024px){.profile-content[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:25px}.details-card[_ngcontent-%COMP%]{order:-1}}@media (max-width: 768px){.profile-container[_ngcontent-%COMP%]{flex-direction:column}.profile-sidebar[_ngcontent-%COMP%]{width:100%;height:60px;min-height:auto}.profile-content[_ngcontent-%COMP%]{padding:20px;grid-template-columns:1fr}.profile-main-info[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:20px}.profile-header[_ngcontent-%COMP%]{padding:20px}.profile-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px}.books-section[_ngcontent-%COMP%]{padding:0 20px 20px}}']})}return o})();var I=c(5861);function U(o,a){1&o&&(e.TgZ(0,"div",6),e._UZ(1,"i",7),e._uU(2," Loading profile... "),e.qZA())}function Z(o,a){if(1&o&&(e.TgZ(0,"div",27),e._UZ(1,"i",28),e._uU(2),e.qZA()),2&o){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.error," ")}}function T(o,a){1&o&&(e.TgZ(0,"div",29),e._UZ(1,"i",30),e._uU(2," Profile updated successfully! Redirecting... "),e.qZA())}function y(o,a){1&o&&(e.TgZ(0,"span"),e._uU(1,"First name is required"),e.qZA())}function N(o,a){1&o&&(e.TgZ(0,"span"),e._uU(1,"First name must be at least 2 characters"),e.qZA())}function A(o,a){if(1&o&&(e.TgZ(0,"div",31),e.YNc(1,y,2,0,"span",32),e.YNc(2,N,2,0,"span",32),e.qZA()),2&o){const t=e.oxw(2);let n,r;e.xp6(1),e.Q6J("ngIf",null==(n=t.profileForm.get("firstName"))||null==n.errors?null:n.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=t.profileForm.get("firstName"))||null==r.errors?null:r.errors.minlength)}}function w(o,a){1&o&&(e.TgZ(0,"span"),e._uU(1,"Last name is required"),e.qZA())}function E(o,a){1&o&&(e.TgZ(0,"span"),e._uU(1,"Last name must be at least 2 characters"),e.qZA())}function j(o,a){if(1&o&&(e.TgZ(0,"div",31),e.YNc(1,w,2,0,"span",32),e.YNc(2,E,2,0,"span",32),e.qZA()),2&o){const t=e.oxw(2);let n,r;e.xp6(1),e.Q6J("ngIf",null==(n=t.profileForm.get("lastName"))||null==n.errors?null:n.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=t.profileForm.get("lastName"))||null==r.errors?null:r.errors.minlength)}}function F(o,a){1&o&&(e.TgZ(0,"span"),e._uU(1,"Email is required"),e.qZA())}function S(o,a){1&o&&(e.TgZ(0,"span"),e._uU(1,"Please enter a valid email address"),e.qZA())}function z(o,a){if(1&o&&(e.TgZ(0,"div",31),e.YNc(1,F,2,0,"span",32),e.YNc(2,S,2,0,"span",32),e.qZA()),2&o){const t=e.oxw(2);let n,r;e.xp6(1),e.Q6J("ngIf",null==(n=t.profileForm.get("email"))||null==n.errors?null:n.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=t.profileForm.get("email"))||null==r.errors?null:r.errors.email)}}function q(o,a){1&o&&e._UZ(0,"i",7)}function D(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",8)(1,"form",9),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onSubmit())}),e.YNc(2,Z,3,1,"div",10),e.YNc(3,T,3,0,"div",11),e.TgZ(4,"div",12)(5,"label",13),e._uU(6,"Username"),e.qZA(),e._UZ(7,"input",14),e.TgZ(8,"small",15),e._uU(9,"Username cannot be changed"),e.qZA()(),e.TgZ(10,"div",12)(11,"label",16),e._uU(12,"First Name"),e.qZA(),e._UZ(13,"input",17),e.YNc(14,A,3,2,"div",18),e.qZA(),e.TgZ(15,"div",12)(16,"label",19),e._uU(17,"Last Name"),e.qZA(),e._UZ(18,"input",20),e.YNc(19,j,3,2,"div",18),e.qZA(),e.TgZ(20,"div",12)(21,"label",21),e._uU(22,"Email"),e.qZA(),e._UZ(23,"input",22),e.YNc(24,z,3,2,"div",18),e.qZA(),e.TgZ(25,"div",23)(26,"button",24),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.cancel())}),e._uU(27," Cancel "),e.qZA(),e.TgZ(28,"button",25),e.YNc(29,q,1,0,"i",26),e._uU(30),e.qZA()()()()}if(2&o){const t=e.oxw();let n,r,i,s,g,d;e.xp6(1),e.Q6J("formGroup",t.profileForm),e.xp6(1),e.Q6J("ngIf",t.error),e.xp6(1),e.Q6J("ngIf",t.success),e.xp6(10),e.ekj("is-invalid",(null==(n=t.profileForm.get("firstName"))?null:n.invalid)&&(null==(n=t.profileForm.get("firstName"))?null:n.touched)),e.xp6(1),e.Q6J("ngIf",(null==(r=t.profileForm.get("firstName"))?null:r.invalid)&&(null==(r=t.profileForm.get("firstName"))?null:r.touched)),e.xp6(4),e.ekj("is-invalid",(null==(i=t.profileForm.get("lastName"))?null:i.invalid)&&(null==(i=t.profileForm.get("lastName"))?null:i.touched)),e.xp6(1),e.Q6J("ngIf",(null==(s=t.profileForm.get("lastName"))?null:s.invalid)&&(null==(s=t.profileForm.get("lastName"))?null:s.touched)),e.xp6(4),e.ekj("is-invalid",(null==(g=t.profileForm.get("email"))?null:g.invalid)&&(null==(g=t.profileForm.get("email"))?null:g.touched)),e.xp6(1),e.Q6J("ngIf",(null==(d=t.profileForm.get("email"))?null:d.invalid)&&(null==(d=t.profileForm.get("email"))?null:d.touched)),e.xp6(4),e.Q6J("disabled",t.profileForm.invalid||t.saving),e.xp6(1),e.Q6J("ngIf",t.saving),e.xp6(1),e.hij(" ",t.saving?"Saving...":"Save Changes"," ")}}let R=(()=>{class o{constructor(t,n,r){this.formBuilder=t,this.keycloakService=n,this.router=r,this.loading=!1,this.saving=!1,this.error=null,this.success=!1}ngOnInit(){this.initForm(),this.loadProfile()}initForm(){this.profileForm=this.formBuilder.group({username:[{value:"",disabled:!0}],firstName:["",[l.kI.required,l.kI.minLength(2)]],lastName:["",[l.kI.required,l.kI.minLength(2)]],email:["",[l.kI.required,l.kI.email]]})}loadProfile(){const t=this.keycloakService.profile;t&&this.profileForm.patchValue({username:t.username,firstName:t.firstName||"",lastName:t.lastName||"",email:t.email||""})}onSubmit(){var t=this;return(0,I.Z)(function*(){t.profileForm.invalid||(t.saving=!0,t.error=null,t.success=!1,t.error="Profile updates must be done through Keycloak account management. Redirecting...",setTimeout(()=>{window.location.href=`${t.keycloakService.keycloakInstance.authServerUrl}/realms/${t.keycloakService.keycloakInstance.realm}/account`},2e3))})()}cancel(){this.router.navigate(["/profile"])}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(l.qu),e.Y36(m.M),e.Y36(p.F0))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-profile-edit"]],decls:9,vars:2,consts:[[1,"profile-edit-container"],[1,"profile-header"],[1,"back-button",3,"click"],[1,"fas","fa-arrow-left"],["class","loading-spinner",4,"ngIf"],["class","profile-content",4,"ngIf"],[1,"loading-spinner"],[1,"fas","fa-spinner","fa-spin"],[1,"profile-content"],[1,"profile-form",3,"formGroup","ngSubmit"],["class","alert alert-error",4,"ngIf"],["class","alert alert-success",4,"ngIf"],[1,"form-group"],["for","username"],["type","text","id","username","formControlName","username","readonly","",1,"form-control"],[1,"form-text"],["for","firstName"],["type","text","id","firstName","formControlName","firstName",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","lastName"],["type","text","id","lastName","formControlName","lastName",1,"form-control"],["for","email"],["type","email","id","email","formControlName","email",1,"form-control"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","fas fa-spinner fa-spin",4,"ngIf"],[1,"alert","alert-error"],[1,"fas","fa-exclamation-circle"],[1,"alert","alert-success"],[1,"fas","fa-check-circle"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(n,r){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1"),e._uU(3,"Edit Profile"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return r.cancel()}),e._UZ(5,"i",3),e._uU(6," Cancel "),e.qZA()(),e.YNc(7,U,3,0,"div",4),e.YNc(8,D,31,15,"div",5),e.qZA()),2&n&&(e.xp6(7),e.Q6J("ngIf",r.loading),e.xp6(1),e.Q6J("ngIf",!r.loading))},dependencies:[f.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u],styles:[".profile-edit-container[_ngcontent-%COMP%]{max-width:600px;margin:2rem auto;padding:0 1rem}.profile-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.profile-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;background:linear-gradient(135deg,#4158D0,#C850C0);-webkit-text-fill-color:transparent;-webkit-background-clip:text;background-clip:text;font-weight:700}.back-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:#f3f4f6;border:none;border-radius:8px;color:#374151;cursor:pointer;transition:all .3s ease}.back-button[_ngcontent-%COMP%]:hover{background:#e5e7eb;transform:translate(-4px)}.loading-spinner[_ngcontent-%COMP%]{text-align:center;color:#6b7280;font-size:1.2rem;padding:3rem}.loading-spinner[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem}.profile-form[_ngcontent-%COMP%]{background:white;border-radius:16px;box-shadow:0 4px 20px #00000014;padding:2rem}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:8px;margin-bottom:1.5rem;display:flex;align-items:center;gap:.5rem}.alert.alert-error[_ngcontent-%COMP%]{background-color:#fee2e2;color:#dc2626;border:1px solid #fecaca}.alert.alert-success[_ngcontent-%COMP%]{background-color:#dcfce7;color:#16a34a;border:1px solid #bbf7d0}.alert[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:600;color:#374151;margin-bottom:.5rem}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:1px solid #d1d5db;border-radius:8px;font-size:1rem;transition:all .3s ease}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#4158d0;box-shadow:0 0 0 3px #4158d01a}.form-group[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc2626}.form-group[_ngcontent-%COMP%]   .form-control[readonly][_ngcontent-%COMP%]{background-color:#f3f4f6;color:#6b7280}.form-group[_ngcontent-%COMP%]   .form-text[_ngcontent-%COMP%]{display:block;font-size:.875rem;color:#6b7280;margin-top:.25rem}.form-group[_ngcontent-%COMP%]   .invalid-feedback[_ngcontent-%COMP%]{color:#dc2626;font-size:.875rem;margin-top:.25rem}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end;margin-top:2rem;padding-top:2rem;border-top:1px solid #e5e7eb}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s ease;border:none;display:inline-flex;align-items:center;gap:.5rem}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4158D0,#C850C0);color:#fff}.btn.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.btn.btn-secondary[_ngcontent-%COMP%]{background-color:#e5e7eb;color:#374151}.btn.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#d1d5db}@media (max-width: 640px){.profile-header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;text-align:center}.profile-form[_ngcontent-%COMP%]{padding:1.5rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%;justify-content:center}}"]})}return o})();var u=c(5775);const L=[{path:"",component:x,canActivate:[u.p],data:{title:"My Profile"}},{path:"edit",component:R,canActivate:[u.p],data:{title:"Edit Profile"}},{path:":username",component:x,canActivate:[u.p],data:{title:"User Profile",publicRoute:!0}}];let J=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(L),p.Bz]})}return o})(),Y=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[f.ez,J,l.u5,l.UX]})}return o})()}}]);